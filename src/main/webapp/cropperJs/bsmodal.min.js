/*!
 * bsModal.js v1.0.5
 * https://github.com/yangchenshin77/bsModal
 *
 * Copyright 2018 Chen-shin, Yang
 * Released under the MIT license
 *
 * Date: 2018-11-27T13:36:09.826Z
 */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=function(o,e){return void 0===e&&(e="undefined"!=typeof window?require("jquery"):require("jquery")(o)),t(e),e}:t(jQuery)}(function(m){function a(o){var e=void 0;e=0<=o.split(",")[0].indexOf("base64")?atob(o.split(",")[1]):unescape(o.split(",")[1]);for(var t=o.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(e.length),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);return new Blob([n],{type:t})}m.fn.bsModal=function(o){var e=this,t={id:"exampleModal",title:"Modal title",titleLavel:5,body:"",label:null,lang:null,modal:null,fade:!0,close:!0,backdrop:!0,confirm:!1,okBtnText:"",cancelBtnText:"",confirmOkText:"",confirmCancelText:"",langs:{},okBtnColor:"primary",cancelBtnColor:"secondary",onOpen:function(){return!0},onClose:function(){return!0},onOk:function(){return!0},onCancel:function(){return!0}},n=m.extend({en:{okBtnText:"Save",cancelBtnText:"Close",confirmOkText:"OK",confirmCancelText:"Cancel"},"zh-TW":{okBtnText:"儲存",cancelBtnText:"關閉",confirmOkText:"確定",confirmCancelText:"取消"}},t.langs),a=n[t.lang]||n[navigator.language||navigator.userLanguage]||n.en;for(var l in a)t[l]=a[l];var r=m.extend({},t,o);r.label=r.label||r.id+"Label",r.confirm&&(r.okBtnText=r.confirmOkText,r.cancelBtnText=r.confirmCancelText,void 0===o.close&&(r.close=!1),void 0===o.backdrop&&(r.backdrop="static"));var i=null;if("string"==typeof r.modal&&(i=m(r.modal)),null===i){i=m('<div class="modal" />').addClass(r.fade?"fade":"").attr({id:r.id,tabindex:"-1",role:"dialog","aria-labelledby":r.label,"data-backdrop":r.backdrop}).appendTo("body");var d=m('<div class="modal-dialog" />').attr({role:"document"}).appendTo(i),c=m('<div class="modal-content" />').appendTo(d),p=m('<div class="modal-header" />').appendTo(c);m("<h"+r.titleLavel+' class="modal-title" />').attr("id",r.label).html(r.title).css("display","inline").appendTo(p),r.body&&m('<div class="modal-body" />').html(r.body).appendTo(c);var s=m('<div class="modal-footer" />').appendTo(c);r.close&&m('<button class="close" type="button" data-dismiss="modal" aria-label="Close" />').append(m('<span aria-hidden="true">&times;</span>')).appendTo(p);var u=m('<button type="button" data-dismiss="modal" />').addClass("btn btn-"+r.cancelBtnColor).text(r.cancelBtnText).appendTo(s),f=m('<button type="button" />').addClass("btn btn-"+r.okBtnColor).text(r.okBtnText).appendTo(s);i.on("shown.bs.modal",function(){r.onOpen.call(e)}),i.on("hidden.bs.modal",function(){r.onClose.call(e)}),f.on("click",function(){!1!==r.onOk.call(e)&&i.modal("hide")}),u.on("click",function(){r.onCancel.call(e)})}return this.modal=i,this.attr({"data-toggle":"modal","data-target":"#"+i.attr("id")}),this},m.fn.bsModalCropper=function(o){var r=this;if("undefined"==typeof Cropper)throw"Error: Cropper.js is not found.";var e={id:"exampleModalCropper",confirm:!0,src:null,imgId:"exampleImage",cropper:{viewMode:1},maxWidth:null,maxHeight:null,action:null,method:"post",fileName:"file",data:{},uploadConfig:{allowTypes:["image/jpeg","image/png"],maxSize:5*Math.pow(1024,2)},success:function(){},error:function(){},axios:null,axiosOriginalData:!1,onUpload:function(){return!0},onUploadError:function(){return!0},onCropper:function(){return!0}},i=m.extend({},e,o);i.cropper=m.extend({},e.cropper,o.cropper),i.uploadConfig=m.extend({},e.uploadConfig,o.uploadConfig);var d=m("<img />").attr("id",i.imgId).css("max-width","100%"),t=void 0;if(i.body=m('<div class="img-container" />').append(d),i.onOpen=function(){t=new Cropper(d.get(0),i.cropper)},i.onOk=function(){var o=t.getCroppedCanvas().toDataURL();t.destroy(),function(o,i,d){if(null===i.width&&null===i.height&&d)return d(o);var c="",p=document.createElement("canvas"),s=p.getContext("2d"),u=new Image;u.src=o,u.onload=function(){var o,e,t,n,a=u.width,l=u.height,r=(o=a,e=l,t=i.width,n=i.height,Math.min(t/o,n/e));p.width=a*r,p.height=l*r,s.drawImage(u,0,0,a,l,0,0,a*r,l*r),c=p.toDataURL(),d&&d(c)}}(o,{width:i.maxWidth,height:i.maxHeight},function(o){if(i.onCropper.call(r,o,a(o)),"string"==typeof i.action){var e=a(o),t=new FormData;t.append(i.fileName,e);var n=Object.keys(i.data);n.length&&n.forEach(function(o){t.append(o,i.data[o])}),function(e,o){if(e.axios)e.axios({url:e.action,method:e.method,data:o,headers:{"Content-Type":"multipart/form-data"}}).then(function(o){e.success(e.axiosOriginalData?o:o.data)}).catch(e.error);else{if(void 0===m.ajax)throw"Error: ajax function is not found, Can't upload image.";m.ajax(e.action,{method:e.method,data:o,processData:!1,contentType:!1,success:e.success,error:e.error})}}(i,t)}})},i.onCancel=function(){t.destroy()},i.src)d.attr("src",i.src),this.bsModal(i);else{var c=this.children("input[type=file]").get(0);c.onchange=function(){if(c.files.length){var e=c.files[0];if(c.value="",!1!==i.onUpload.call(r)){var o,t,n;if(i.uploadConfig.allowTypes)if(!i.uploadConfig.allowTypes.some(function(o){return o===e.type}))return void i.onUploadError.call(r,"Upload file type is wrong");if(i.uploadConfig.maxSize){var a=i.uploadConfig.maxSize;if(e.size>a){var l=void 0;return a<1024?l=a+" B":a>=Math.pow(1024,1)&&a<Math.pow(1024,2)?l=Math.floor(a/Math.pow(1024,1))+" KB":a>=Math.pow(1024,2)&&a<Math.pow(1024,3)&&(l=Math.floor(a/Math.pow(1024,2))+" MB"),void i.onUploadError.call(r,"Uploaded file cannot be larger than "+l)}}o=e,t=function(o){i.src=o,d.attr("src",i.src),r.bsModal(i),r.modal.modal("show"),r.removeAttr("data-toggle").removeAttr("data-target")},(n=new FileReader).onload=function(o){t(o.target.result)},n.readAsDataURL(o)}}}}return this}});